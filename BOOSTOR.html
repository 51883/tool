<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>BOOSTOR Pro - å‡ ä½•è®¡ç®—å™¨</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    /* === å…¨å±€æ ·å¼ === */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --primary: #0f172a;
      --accent: #3b82f6;
      --bg-body: #f1f5f9;
      --bg-card: #ffffff;
      --text-main: #1e293b;
      --text-sub: #64748b;
      --border: #e2e8f0;
      --radius: 12px;
    }
    body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background-color: var(--bg-body); color: var(--text-main); padding: 20px 10px; line-height: 1.5; }
    .container { max-width: 800px; margin: 0 auto; }
    
    h1 { text-align: center; font-weight: 800; font-size: 1.8rem; color: var(--primary); margin-bottom: 5px; }
    .sub-header { text-align: center; color: var(--text-sub); margin-bottom: 30px; font-size: 0.9rem; }
    
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
    @media(max-width: 640px) { .grid-2 { grid-template-columns: 1fr; } }
    
    .panel { background: var(--bg-card); padding: 20px; border-radius: var(--radius); box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 1px solid var(--border); }
    .panel-header { font-size: 1rem; font-weight: 700; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center; }
    .panel-new { border-top: 4px solid #3b82f6; }
    
    .input-group { margin-bottom: 15px; }
    label { display: block; font-size: 0.75rem; text-transform: uppercase; color: var(--text-sub); font-weight: 700; margin-bottom: 6px; }
    input, select { width: 100%; padding: 12px; font-size: 1rem; border: 1px solid var(--border); border-radius: 8px; background: #fff; font-weight: 600; color: var(--primary); transition: border 0.2s; }
    input:focus, select:focus { outline: none; border-color: var(--accent); ring: 2px solid #bfdbfe; }
    
    .highlight-input { background-color: #fffbeb; border-color: #fcd34d; color: #b45309; }
    
    /* ç»“æœå¡ç‰‡ */
    .result-card { background: var(--primary); color: #fff; border-radius: var(--radius); padding: 25px; margin-top: 20px; display: none; }
    .result-header { font-size: 1.1rem; font-weight: 700; margin-bottom: 20px; text-align: center; color: #93c5fd; }
    
    .metric-grid { display: flex; justify-content: space-around; text-align: center; gap: 10px; }
    .metric-box { flex: 1; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; }
    .metric-val { font-size: 1.8rem; font-weight: 800; line-height: 1.2; }
    .metric-label { font-size: 0.8rem; opacity: 0.8; margin-top: 5px; text-transform: uppercase; }
    .metric-diff { font-size: 0.9rem; font-weight: 600; padding: 4px 8px; border-radius: 4px; margin-top: 8px; display: inline-block; }
    .diff-plus { background: #dcfce7; color: #166534; } /* ç»¿è‰² */
    .diff-minus { background: #fee2e2; color: #991b1b; } /* çº¢è‰² */
    .diff-neutral { background: #f1f5f9; color: #475569; }

    /* è§£é‡Šæ¡† */
    .explain-box { background: #fff; border: 1px dashed #cbd5e1; border-radius: var(--radius); padding: 20px; margin-top: 20px; font-size: 0.9rem; color: #475569; line-height: 1.6; }
    .explain-title { font-weight: 700; color: #0f172a; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
    .formula-row { display: flex; justify-content: space-between; border-bottom: 1px solid #f1f5f9; padding: 6px 0; }
    .formula-val { font-weight: 600; color: #334155; }
  </style>
</head>
<body>

<div class="container">
  <h1>BOOSTOR Pro</h1>
  <div class="sub-header">Fixed Rise (54mm) å¿«é€Ÿè®¾å®šç³»ç»Ÿ</div>

  <div class="grid-2">
    <div class="panel">
      <div class="panel-header">ğŸš² åŸè½¦è®¾å®š (Old)</div>
      
      <div class="input-group">
        <label>æŠŠç«‹é•¿åº¦ (mm)</label>
        <input type="number" id="oldStemLen" value="100" placeholder="ä¾‹å¦‚ 100">
      </div>
      
      <div class="grid-2" style="margin-bottom:0; gap:10px;">
        <div class="input-group">
            <label>æŠŠç«‹è§’åº¦ (Â°)</label>
            <input type="number" id="oldStemAng" value="-6" placeholder="-6">
        </div>
        <div class="input-group">
            <label>è½¦æŠŠ Reach</label>
            <input type="number" id="oldBarReach" value="80" placeholder="80">
        </div>
      </div>

      <div class="input-group">
        <label>å«åœˆé«˜åº¦ (Spacer)</label>
        <input type="number" id="oldSpacer" value="20" placeholder="20">
      </div>
    </div>

    <div class="panel panel-new">
      <div class="panel-header">ğŸš€ ç›®æ ‡è®¾å®š (New)</div>
      
      <div class="input-group">
        <label>é€‰æ‹©äº§å“è§„æ ¼ (Fixed Rise 54mm)</label>
        <select id="newProduct">
          <option value="none" selected disabled>è¯·é€‰æ‹©...</option>
          <option value='{"len":102.4, "ang":14.8, "name":"æŠŠé•¿ 90"}'>æŠŠé•¿ 90mm (ç­‰æ•ˆ)</option>
          <option value='{"len":113.6, "ang":11.4, "name":"æŠŠé•¿ 100"}'>æŠŠé•¿ 100mm (ç­‰æ•ˆ)</option>
          <option value='{"len":122.8, "ang":9.2,  "name":"æŠŠé•¿ 110"}'>æŠŠé•¿ 110mm (ç­‰æ•ˆ)</option>
          <option value='{"len":131.6, "ang":7.2,  "name":"æŠŠé•¿ 120"}'>æŠŠé•¿ 120mm (ç­‰æ•ˆ)</option>
          <option value='{"len":140.7, "ang":5.56, "name":"æŠŠé•¿ 130"}'>æŠŠé•¿ 130mm (ç­‰æ•ˆ)</option>
        </select>
      </div>

      <div class="input-group">
        <label>æ–°è½¦æŠŠ Reach (å›ºå®š)</label>
        <input type="number" id="newBarReach" value="70" readonly style="background:#f1f5f9; color:#94a3b8;">
      </div>

      <div class="input-group">
        <label style="color:#d97706;">ğŸ”§ æ¨¡æ‹Ÿè°ƒæ•´ï¼šæ–°å«åœˆé«˜åº¦ (Spacer)</label>
        <input type="number" id="newSpacer" value="10" class="highlight-input">
      </div>
    </div>
  </div>

  <div id="resultCard" class="result-card">
    <div class="result-header">å‡ ä½•å˜åŒ–åˆ†æ</div>
    
    <div class="metric-grid">
      <div class="metric-box">
        <div class="metric-label">â†•ï¸ å‚ç›´é«˜åº¦ (Height)</div>
        <div class="metric-val" id="resStackDiff">0</div>
        <div id="resStackTag" class="metric-diff diff-neutral">ä¸å˜</div>
      </div>

      <div class="metric-box">
        <div class="metric-label">â†”ï¸ å‰ä¼¸è·ç¦» (Reach)</div>
        <div class="metric-val" id="resReachDiff">0</div>
        <div id="resReachTag" class="metric-diff diff-neutral">ä¸å˜</div>
      </div>
    </div>
  </div>

  <div class="explain-box" id="explainBox" style="display:none;">
    <div class="explain-title">ğŸ¤” æ€ä¹ˆç®—çš„ï¼Ÿ(ç®—æ³•è§£æ)</div>
    
    <div style="margin-bottom:15px; font-weight:600; color:#3b82f6;">
      1. å…³äºå‡é«˜ (Height/Stack):
    </div>
    <div class="formula-row">
      <span>æ—§è½¦é«˜åº¦ â‰ˆ å«åœˆ + (æ—§æŠŠç«‹é•¿åº¦ Ã— 0.2)</span>
      <span class="formula-val" id="expOldStack">--</span>
    </div>
    <div class="formula-row">
      <span>æ–°è½¦é«˜åº¦ = æ–°å«åœˆ + 54mm (å›ºå®šå€¼)</span>
      <span class="formula-val" id="expNewStack">--</span>
    </div>
    <div style="font-size:0.8em; color:#94a3b8; margin-top:4px;">
      *æ³¨ï¼šæ™®é€š-6Â°æŠŠç«‹å¹¶éæ°´å¹³ï¼Œçº¦æœ‰20%é•¿åº¦çš„è‡ªç„¶æŠ¬å‡ã€‚æ–°è½¦æŠŠåˆ™æ˜¯å›ºå®šçš„54mmå‡ ä½•æŠ¬å‡ã€‚
    </div>

    <div style="margin:15px 0 5px 0; font-weight:600; color:#3b82f6;">
      2. å…³äºå‰ä¼¸ (Reach):
    </div>
    <div class="formula-row">
      <span>æ—§è½¦è·ç¦» â‰ˆ (æ—§æŠŠç«‹ Ã— 0.98) + æ—§Reach</span>
      <span class="formula-val" id="expOldReach">--</span>
    </div>
    <div class="formula-row">
      <span>æ–°è½¦è·ç¦» = (æ–°æŠŠç«‹ Ã— è§’åº¦æŠ˜ç®—) + 70mm</span>
      <span class="formula-val" id="expNewReach">--</span>
    </div>
    <div style="font-size:0.8em; color:#94a3b8; margin-top:4px;">
      *æ³¨ï¼šå‰ä¼¸é‡ç”±â€œæŠŠç«‹æ°´å¹³æŠ•å½±â€å’Œâ€œè½¦æŠŠReachâ€å…±åŒå†³å®šã€‚
    </div>
  </div>

</div>

<script>
  // è·å–DOM
  const dom = {
    oldLen: document.getElementById('oldStemLen'),
    oldAng: document.getElementById('oldStemAng'),
    oldSpacer: document.getElementById('oldSpacer'),
    oldBarReach: document.getElementById('oldBarReach'),
    newProduct: document.getElementById('newProduct'),
    newSpacer: document.getElementById('newSpacer'),
    newBarReach: document.getElementById('newBarReach'),
    
    // ç»“æœåŒº
    card: document.getElementById('resultCard'),
    explain: document.getElementById('explainBox'),
    stackDiff: document.getElementById('resStackDiff'),
    stackTag: document.getElementById('resStackTag'),
    reachDiff: document.getElementById('resReachDiff'),
    reachTag: document.getElementById('resReachTag'),
    
    // è§£é‡ŠåŒºæ•°å€¼
    expOldStack: document.getElementById('expOldStack'),
    expNewStack: document.getElementById('expNewStack'),
    expOldReach: document.getElementById('expOldReach'),
    expNewReach: document.getElementById('expNewReach'),
  };

  // ç›‘å¬æ‰€æœ‰è¾“å…¥
  document.querySelectorAll('input, select').forEach(el => {
    el.addEventListener('input', calculate);
    el.addEventListener('change', calculate);
  });

  function calculate() {
    const pVal = dom.newProduct.value;
    if (pVal === "none") return;

    // 1. è·å–åŸºç¡€æ•°æ®
    const spec = JSON.parse(pVal); // è·å–é€‰ä¸­çš„æ–°æŠŠç«‹å‚æ•°
    
    const old = {
      len: parseFloat(dom.oldLen.value) || 0,
      ang: parseFloat(dom.oldAng.value) || -6,
      spacer: parseFloat(dom.oldSpacer.value) || 0,
      reach: parseFloat(dom.oldBarReach.value) || 0
    };

    const target = {
      spacer: parseFloat(dom.newSpacer.value) || 0,
      fixedRise: 54, // æ ¸å¿ƒå–ç‚¹ï¼šå›ºå®š54
      fixedReach: 70 // æ–°è½¦æŠŠå›ºå®šReach
    };

    // 2. æ ¸å¿ƒç®—æ³• (ç§¯æœ¨æ³• + ç®€å•ä¿®æ­£)
    
    // --- å‡é«˜ (Stack) è®¡ç®— ---
    // æ—§è½¦ï¼šå«åœˆ + æŠŠç«‹çš„è‡ªç„¶æŠ¬å‡ã€‚
    // ç»éªŒå…¬å¼ï¼š-6åº¦æŠŠç«‹åœ¨73åº¦å¤´ç®¡ä¸Šï¼Œæ¯10mmé•¿åº¦çº¦æä¾›2mmå‚ç›´æŠ¬å‡ (å³ç³»æ•° 0.2)
    // å¦‚æœæŠŠç«‹è§’åº¦å¾ˆå¤¸å¼ (æ¯”å¦‚-17)ï¼Œç³»æ•°ä¼šå˜ï¼Œä½†ä¸ºäº†ç®€å•ç›´è§‰ï¼Œæˆ‘ä»¬è®¾å®šä¸€ä¸ªåŸºå‡†é€»è¾‘
    let oldStemRiseFactor = 0.2; 
    if(old.ang <= -15) oldStemRiseFactor = 0.05; // -17åº¦æŠŠç«‹å‡ ä¹å¹³çš„
    if(old.ang >= 0) oldStemRiseFactor = 0.35;   // æ­£è§’åº¦æŠŠç«‹æŠ¬å‡å¾ˆå¤§
    
    const oldStack = old.spacer + (old.len * oldStemRiseFactor);
    const newStack = target.spacer + target.fixedRise;
    const diffStack = newStack - oldStack;

    // --- å‰ä¼¸ (Reach) è®¡ç®— ---
    // æ—§è½¦ï¼šæŠŠç«‹æ°´å¹³é•¿åº¦ + è½¦æŠŠReach
    // ç»éªŒå…¬å¼ï¼šæŠŠç«‹æœ‰ä¸€å®šçš„ä»°è§’ï¼Œæ‰€ä»¥æ°´å¹³é•¿åº¦ç•¥å°äºç‰©ç†é•¿åº¦ (ä¹˜ä»¥0.96~0.99)
    const oldReachTotal = (old.len * 0.98) + old.reach;
    
    // æ–°è½¦ï¼šç‰©ç†é•¿åº¦ * cos(ç‰©ç†è§’åº¦) + å›ºå®šReach
    // è¿™é‡Œç”¨Math.cosç®—ä¸€ä¸‹æ°´å¹³æŠ•å½±ï¼Œä¿è¯å‡†ç¡®ï¼Œä½†å¯¹å¤–è§£é‡Šè¯´â€œæŠ˜ç®—â€
    const rad = Math.PI / 180;
    // è¿™é‡Œçš„è§’åº¦è¦è€ƒè™‘å¤´ç®¡è§’(73)ï¼Œä½†ä¸ºäº†ç®€åŒ–ç›´æ¥ç”¨äº§å“è‡ªå¸¦çš„ç‰©ç†è§’åº¦ç®—æ°´å¹³æŠ•å½±
    // ç®€å•è¿‘ä¼¼ï¼šæ–°æŠŠç«‹æ˜¯ä¸ºäº†åšé«˜è€Œå€¾æ–œçš„ï¼Œæ‰€ä»¥æ°´å¹³è·ç¦» = ç‰©ç†é•¿ * cos(ç‰©ç†è§’)
    // æ³¨æ„ï¼šè¿™é‡Œçš„spec.angæ˜¯é’ˆå¯¹æŠŠç«‹æœ¬èº«çš„ï¼Œæˆ‘ä»¬ç¨å¾®åšä¸ªç®€å•æŠ•å½±
    const newStemHorizontal = spec.len * Math.cos(spec.ang * rad); 
    const newReachTotal = newStemHorizontal + target.fixedReach;
    
    const diffReach = newReachTotal - oldReachTotal;

    // 3. æ¸²æŸ“ç»“æœ
    dom.card.style.display = 'block';
    dom.explain.style.display = 'block';

    updateMetric(dom.stackDiff, dom.stackTag, diffStack, 'mm');
    updateMetric(dom.reachDiff, dom.reachTag, diffReach, 'mm');

    // 4. æ›´æ–°è§£é‡Šæ–‡æ¡ˆ
    dom.expOldStack.innerText = `${old.spacer} + ${Math.round(old.len * oldStemRiseFactor)} = ${Math.round(oldStack)}mm`;
    dom.expNewStack.innerText = `${target.spacer} + 54 = ${newStack}mm`;
    
    dom.expOldReach.innerText = `${Math.round(old.len * 0.98)} + ${old.reach} = ${Math.round(oldReachTotal)}mm`;
    dom.expNewReach.innerText = `${Math.round(newStemHorizontal)} + ${target.fixedReach} = ${Math.round(newReachTotal)}mm`;
  }

  function updateMetric(elVal, elTag, val, unit) {
    const absVal = Math.abs(val).toFixed(1);
    elVal.innerText = absVal + unit;

    if (Math.abs(val) < 2) {
      elTag.innerText = "åŸºæœ¬ä¸å˜";
      elTag.className = "metric-diff diff-neutral";
      elTag.style.background = "#f1f5f9";
      elTag.style.color = "#64748b";
    } else if (val > 0) {
      elTag.innerText = "å¢åŠ  (æ›´é•¿/æ›´é«˜)";
      elTag.className = "metric-diff diff-plus";
    } else {
      elTag.innerText = "å‡å°‘ (æ›´çŸ­/æ›´ä½)";
      elTag.className = "metric-diff diff-minus";
    }
  }

</script>
</body>
</html>
